# 2025-07-22 - 캐싱 전략

## 캐싱 전략

- 데이터를 캐시(Cache)에 저장하고 관리해 활용하는 방식에 대한 접근법
- 원본 데이터(DB, 외부 API) 보다 가까운 곳에 임시로 저장해두는 공간

### 목표

- 성능 향상: 자주 접근하는 데이터를 빠르게 제공해 응답 시간 단축
- 원본 시스템 부하 감소: 직접적인 접근 횟수를 줄여 부하 경감
- 네트워크 비용 절감: 트래픽 감소

## 캐싱 전략 방식

1. Cache-Aside (Lazy Loading/ 지연로딩)
   - 일반적이고 보편적인 전략
   - 동작 방식
     1. 데이터 요청 시, 캐시 확인
     2. 캐시 있는 경우 (Cache Hit), 캐시에서 데이터 즉시 반환
     3. 캐시 없는 경우 (Cache Miss), 원본 DB 에서 데이터 조회
     4. DB에서 데이터 가져온 후, 캐시에 저장하고 사용자에게 반환
   - 장점
     - 캐시에 실제로 요청된 데이터만 저장, 공간이 효율적
     - 읽기 위주의 동작에 적합
   - 단점
     - 캐시 미스에는 원본 DB 접근 + 캐시 업데이트로 초기 응답 시간 길어짐
     - 데이터 변경 시, 캐시와 DB간의 데이터 불일치 애플리케이션에서 직접 관리

2. Write-Through (쓰기 통과)
   - 동작 방식
     1. 애플리케이션이 데이터를 쓸 때, 데이터를 캐시와 DB 동시에 기록
     2. 두 곳 모두 쓰기 작업이 성공해야 성공
   - 장점
     - 캐시 DB간 일관 성 유지
     - 읽기 시 캐시 히트율이 높아 빠른 응답
   - 단점
     - 쓰기 작업 시, 캐시 DB 모두 기록해 쓰기 성능 저하
     - 캐시 필요 없는 데이터에도 적용되 비효율적

3. Write-Back (Write-Behind/ 쓰기 지연)
   - 동작 방식
     1. 애플리케이션에 데이터 쓸 때, 캐시에만 기록하고 즉시 클라이언트에 성공 응답 전송
     2. 캐시에 기록된 데이터를 비동기적(일정 시간 후 또는 배치)으로 원본 DB에 기록
   - 장점
     - 쓰기 성능 매우 빠름
     - 연속적인 동일 업데이트 시, 캐시에서 업데이트 하다 최종 상태만 DB에 기록
   - 단점
     - 캐시에만 기록되어 캐시 서버 장애 발생 시 데이터 손실
     - 일관성 보장이 더욱 어려움

4. Read-Through (읽기 통과)
   - 동작 방식:
     1. `Cache-Aside`와 유사하게, 애플리케이션은 캐시에서 데이터 요청
     2. 캐시 자체가 없을 경우 원본 DB에서 데이터 조회하는 로직 내장
     3. 캐시가 데이터를 DB에서 가져와 캐시에 저장 후, 애플리케이션 반환
   - 장점
     - 애플리케이션 코드에서 캐시 미스 시, dB 접근 로직을 직접 구현할 필요 없어 코드 복잡성 저하
     - 캐시를 데이터 소스처럼 활용
   - 단점
     - 캐싱 시스템 자체에 원본 DB 로직이 있어야하므로 구현이 복잡할 수 있음
     - 초기 캐시 미스 시 지연 발생

## 캐시 무효화(Cache Invalidation) 및 제거 정책(Eviction Policy)

- 어떤 전략 이든, 원본 데이터와 일치하지 않는 데이터 불일치 문제 발생 가능  
- 이를 관리 하는 것이 캐시 무효화
- 캐시 공간을 확보하기 위해 어떤 데이터를 제거할 지 결정하는 제거 정책도 중요

## 요약

> 캐싱 전략은 시스템 성능 향상과 부하 감소를 위해 데이터를 캐시에 저장하고 관리
> 주요 전략으로는 `Cache-Aside`, `Write-Through`, `Write-Back(Write-Behind)`, `Read-Through` 전략이 있음
> 추가적으로, 캐시 무효화와 제거 정책도 적절히 고려해야함